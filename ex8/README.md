# 点検簿の作成

今年度から居室を移動し、日々の点検をつけることになった。
エクセルで表を作ってもよかったが、曜日と祝日は自動で
入力したかったのでlatex原稿をプログラムで作り、
LaTeX原稿からpdfファイルを作りそれを印刷して点検簿と
することにした。

生成物:
- [LaTeXファイル](tenkenbo.2025-05.tex)
- [PDFファイル](tenkenbo.2025-05.pdf)

## 実習環境の確認

```
% which latex
/usr/local/texlive/bin/latex
```

となることを確認してください。

## コマンドラインインターフェイスの設計

月ごとの点検簿なので、何月の点検簿を作るのかの情報を
プログラムにあたえる必要がある。ここでは

- なにも指定しなければプログラム実行時の月を使う
- 引数がひとつ指定されていればその年の、指定された月を使う
- 引数がふたつ指定されていれば、第1引数を月、第2引数を年として使う

ものを作った。

## 走らせかた

日本の祝日情報は
[JPHoliday](https://github.com/Lalcs/jpholiday)モジュールを
使っているのでまずそれをセットする:

```
pip3 install jpholiday --user
```

セット後

```
./tenkenbo.py3
```
とすると、今月の点検簿TeXファイルとPDF(tenkenbo.2025-06.pdf)ができる。

## 動作

プログラムは以下のように動作する。

1. TeX原稿を作る
2. TeX原稿をplatexコマンドで処理してdviファイルを作る
3. dviファイルをdvipdfmxでpdfファイルを作る
4. dviファイルを作るさいに作成されるログその他必要ないファイルを削除する
(TeX原稿はあとで使うかもしれないので残しておく)。

## 使用したモジュールの説明

Linuxコマンドをpythonスクリプト内から走らせるには
subprocessモジュールを使うことが多い。
例題ではplatexコマンドをpythonスクリプト内から起動するために
subprocessモジュールを使っている。

コマンドを起動するには``subprocess.run()``メソッドを使う。
走らせるコマンドは第1引数でリストで指定する。リストの最初の要素はコマンド名を
指定する。コマンド引数が必要な場合はそのあとの要素で指定する。

実行したコマンド結果の標準出力をキャプチャしたい場合は
``capture_output = True``を指定する。

例: date -u (現在時刻をUTCで表示するコマンド)

```
output = subprocess.run(['date', '-u'], capture_output = True)
print(output.stdout.decode().strip())
```
